<!DOCTYPE html>
<html lang="tr">
<!-- lol -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒ∞hsans Gate - Survival Mod</title>
    <meta name="description" content="ƒ∞ngilizce kelime daƒüarcƒ±ƒüƒ±nƒ±zƒ± geli≈ütirin.">
    <link rel="stylesheet" href="css/style.css?v=13">
    <link rel="stylesheet" href="css/grammar-topics.css">
    <link rel="stylesheet" href="css/writing-mode.css">
    <link rel="stylesheet" href="css/reading.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- Preload Critical Images -->
    <link rel="preload" as="image" href="assets/game-bg-galaxy.png">
    <link rel="preload" as="image" href="assets/modes-bg.png">
    <link rel="preload" as="image" href="assets/writing-bg.png">
</head>

<body>
    <div class="app-container">


        <main id="app-content">

            <!-- READING MODE VIEW -->
            <div id="view-reading" class="view hidden">
                <!-- Library View -->
                <div id="reading-library">
                    <div class="game-header-bar">
                        <button class="btn-icon library-back-btn" onclick="app.returnToDashboard()"
                            title="Ana Men√º">&larr;</button>
                        <h2 style="margin:0; font-size:1.5rem;">K√ºt√ºphane</h2>
                        <div style="width:40px;"></div>
                    </div>
                    <div class="library-grid" id="library-grid">
                        <!-- Books injected via JS -->
                    </div>
                </div>

                <!-- Reader View -->
                <div id="reading-reader" class="hidden">
                    <div class="reader-header">
                        <button class="reader-back-btn" onclick="app.closeBook()"
                            title="K√ºt√ºphaneye D√∂n">&larr;</button>

                        <div class="reader-search-box">
                            <input type="text" id="dictionary-search" autocomplete="off"
                                placeholder="S√∂zl√ºk: Kelime ara..." oninput="app.handleSearchInput(this.value)"
                                onblur="app.hideSuggestions()"
                                onkeyup="if(event.key === 'Enter') { app.lookupWord(this.value); app.hideSuggestions(); }">
                            <span class="search-icon">üîç</span>
                            <div id="search-suggestions" class="search-suggestions"></div>
                        </div>

                        <div class="reader-header-title" style="text-align: right;">
                            <h3 id="reader-book-title">Book Title</h3>
                            <span id="reader-book-level">Level A1</span>
                        </div>
                    </div>
                    <div class="reader-container">
                        <div class="book-frame">
                            <div id="reader-content" class="reader-content">
                                <!-- Text injected via JS -->
                            </div>
                        </div>
                    </div>
                    <!-- Pagination Controls -->
                    <div class="reader-pagination">
                        <button id="btn-prev-page" class="pagination-btn" onclick="app.prevBookPage()"
                            title="√ñnceki Sayfa">
                            ‚Üê
                        </button>
                        <span id="page-indicator" class="page-indicator">Sayfa 1 / 1</span>
                        <button id="btn-next-page" class="pagination-btn" onclick="app.nextBookPage()"
                            title="Sonraki Sayfa">
                            ‚Üí
                        </button>
                    </div>
                </div>


            </div>

            <!-- LANDING VIEW -->
            <div id="view-landing" class="view active">
                <div class="landing-container">
                    <div class="landing-logo">
                        <span class="logo-icon-lg">üî•</span>
                        <h1>ƒ∞hsans<span class="highlight">Gate</span></h1>
                        <p class="subtitle">Profesyonel ƒ∞ngilizce Geli≈üim Platformu</p>
                    </div>

                    <div class="landing-form">
                        <div class="login-choices">
                            <button class="btn btn-primary btn-large" onclick="app.enterDashboard()"
                                style="width:100%;">
                                üéÆ Oyuna Ba≈üla
                            </button>
                            <button class="btn btn-secondary btn-large" style="margin-top: 1rem; width:100%;"
                                onclick="app.checkAdminAuth()">
                                üõ°Ô∏è Y√∂netici Paneli
                            </button>
                        </div>
                    </div>

                    <!-- Removed old explicit admin link, now integrated above -->
                </div>
            </div>

            <!-- DASHBOARD VIEW (Main Hub) -->
            <div id="view-dashboard" class="view hidden">
                <div class="dashboard-hub">

                    <!-- WELCOME SECTION -->
                    <div class="hub-header">
                        <!-- Dashboard Top Bar: Profile, Logo & Wallet -->
                        <div class="dashboard-top-bar">
                            <!-- Profile Section (Left) -->
                            <div class="user-profile">
                                <div class="profile-avatar-container" onclick="app.toggleProfileMenu()">
                                    <img id="header-avatar" src="assets/avatars/avatar_1.png" class="header-avatar-img"
                                        style="width:24px; height:24px; border-radius:50%; display:none;">
                                    <span class="user-name" id="display-user-name-header">Misafir</span>
                                    <span class="dropdown-arrow">‚ñº</span>
                                </div>

                                <!-- Dropdown -->
                                <div class="profile-dropdown hidden" id="profile-dropdown">
                                    <button class="profile-menu-item"
                                        onclick="app.logout(); event.stopPropagation();">üö™ √áƒ±kƒ±≈ü</button>
                                </div>
                            </div>

                            <!-- Logo (Center) -->
                            <div class="logo">
                                <div class="logo-row">
                                    <span class="logo-icon">üî•</span>
                                    <h1>ƒ∞hsans<span class="highlight">Gate</span></h1>
                                </div>
                            </div>

                            <!-- Trophies (Right) -->
                            <button class="btn-icon trophy-btn" onclick="app.openGlobalLeaderboard()"
                                title="Global Sƒ±ralama">
                                <span class="trophy-icon">üèÜ</span>
                                <span id="header-total-score">0</span>
                            </button>
                        </div>

                        <div class="hub-welcome">
                            <h3>üëã Ho≈ü geldin, <span id="display-user-name-welcome">Oyuncu</span></h3>
                            <p class="quote-day">"Her yeni kelime, yeni bir d√ºnyadƒ±r."</p>
                        </div>

                    </div>

                    <!-- MAIN CONTENT GRID -->
                    <div class="dashboard-content">
                        <!-- Left: Main Modules -->
                        <div class="modules-grid">
                            <!-- Word Study -->
                            <div class="module-card hero" onclick="app.openModeSelection()">
                                <div class="icon-box">üìö</div>
                                <div class="module-info">
                                    <h4>Kelime √áalƒ±≈ümasƒ±</h4>
                                    <p>Kelime hazineni geli≈ütir.</p>
                                </div>
                                <div class="hover-glow"></div>
                            </div>

                            <!-- Grammar (Unlocked) -->
                            <div class="module-card" onclick="app.openGrammarLevelSelection()">
                                <div class="icon-box">üß†</div>
                                <div class="module-info">
                                    <h4>Dil Bilgisi</h4>
                                    <p>Bo≈üluk Doldurma</p>
                                </div>
                                <div class="hover-glow"></div>
                            </div>

                            <!-- Reading (Unlocked) -->
                            <div class="module-card" onclick="app.openReadingMode()">
                                <div class="icon-box">üìñ</div>
                                <div class="module-info">
                                    <h4>Okuma</h4>
                                    <p>Hikaye ve Kitaplar</p>
                                </div>
                                <div class="hover-glow"></div>
                            </div>

                            <!-- Writing (New) -->
                            <div class="module-card" onclick="app.openWritingModes()">
                                <div class="icon-box">‚úçÔ∏è</div>
                                <div class="module-info">
                                    <h4>Yazma</h4>
                                    <p>Kelime olu≈ütur.</p>
                                </div>
                                <div class="hover-glow"></div>
                            </div>
                        </div>

                        <!-- Right / Bottom: Stats or Quick Actions -->

                    </div>
                </div>
            </div>

            <!-- WRITING MODES SELECTION (New) -->
            <div id="view-writing-modes" class="view hidden">
                <div class="modes-split-layout"
                    style="justify-content:center; align-items:center; flex-direction:column; padding-top:6rem;">

                    <div class="modes-header-group" style="text-align:center; margin-bottom:3rem;">
                        <button class="btn-icon back-btn-top" onclick="app.showDashboard()" title="Geri"
                            style="position:absolute; top:2rem; left:2rem;">
                            &larr;
                        </button>
                        <h2 style="font-size:2.5rem;">Yazma Modu</h2>
                        <p style="color:var(--text-secondary);">Nasƒ±l √ßalƒ±≈ümak istersin?</p>
                    </div>

                    <div class="mode-grid-compact"
                        style="display:flex; gap:1.5rem; justify-content:center; flex-direction:column; width:100%; align-items:center;">
                        <!-- Scramble Mode -->
                        <div class="mode-card compact" onclick="app.startWritingMode()"
                            style="width:100%; max-width:350px; text-align:center; display:block; padding:2rem;">
                            <div class="mode-icon" style="font-size:3rem; margin-bottom:1rem;">üß©</div>
                            <div class="mode-info">
                                <h3>Harf Birle≈ütirme</h3>
                                <p>Karƒ±≈üƒ±k harfleri d√ºzelt.</p>
                            </div>
                        </div>

                        <!-- Direct Input Mode -->
                        <div class="mode-card compact" onclick="app.startWritingInputMode()"
                            style="width:100%; max-width:350px; text-align:center; display:block; padding:2rem;">
                            <div class="mode-icon" style="font-size:3rem; margin-bottom:1rem;">‚å®Ô∏è</div>
                            <div class="mode-info">
                                <h3>Kelime Yazma</h3>
                                <p>ƒ∞ngilizcesini kendin yaz.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- WRITING INPUT VIEW (Split Layout) -->
            <div id="view-writing-input" class="view hidden" style="position:relative;">
                <!-- START OVERLAY (Quota Saver) -->
                <div id="writing-input-start-overlay"
                    style="position:absolute; inset:0; background:rgba(15, 23, 42, 0.95); z-index:1000; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center;">
                    <div style="font-size:4rem; margin-bottom:1rem;">ü§ñ</div>
                    <h2 style="font-size:2rem; margin-bottom:0.5rem; color:var(--accent-gold);">Hazƒ±r mƒ±sƒ±n?</h2>
                    <p style="color:var(--text-secondary); max-width:400px; margin-bottom:2rem;">
                        Ba≈üla butonuna bastƒ±ƒüƒ±nda Yapay Zeka senin i√ßin √∂zel bir soru hazƒ±rlayacak.
                    </p>
                    <button class="btn btn-primary" style="font-size:1.5rem; padding:1rem 3rem;"
                        onclick="app.beginProWritingSession()">
                        BA≈ûLA üöÄ
                    </button>
                    <button class="btn btn-text" style="margin-top:1rem;" onclick="app.openWritingModes()">Geri
                        D√∂n</button>
                </div>

                <div class="split-screen-container">

                    <!-- LEFT: Task Pane -->
                    <div class="task-pane">
                        <!-- task-header removed -->

                        <div class="task-content">
                            <h2 id="input-target-meaning" class="task-question-text">Loading...</h2>

                            <div class="task-input-wrapper">
                                <textarea id="writing-direct-input" class="task-textarea"
                                    placeholder="T√ºrk√ßesi nedir?..." rows="2"
                                    onkeydown="if(event.key === 'Enter') { event.preventDefault(); app.checkWritingInputAnswer(); }"></textarea>
                            </div>
                        </div>

                        <div class="task-actions">
                            <button id="btn-check-answer" class="btn-action check"
                                onclick="app.checkWritingInputAnswer()">KONTROL ET</button>
                            <button id="btn-next-question" class="btn-action next hidden"
                                onclick="app.nextWritingQuestion()">DEVAM ET ‚û°</button>
                        </div>
                    </div>

                    <!-- RIGHT: AI Chat Pane -->
                    <div class="chat-pane">
                        <div class="chat-header" style="justify-content: space-between;">
                            <button class="btn-icon back-btn-simple" onclick="app.openWritingModes()"
                                style="margin-right:0;">&larr;</button>

                            <div style="display:flex; align-items:center; gap:0.5rem;">
                                <span class="ai-avatar">ü§ñ</span>
                                <div class="ai-info">
                                    <span class="ai-name">AI Asistan</span>
                                    <span class="ai-status">√áevrimi√ßi</span>
                                </div>
                            </div>
                            <button id="btn-music" class="btn-music" onclick="app.toggleMusic()" title="M√ºzik A√ß/Kapat">
                                üéµ
                            </button>
                            <div class="user-profile">
                                <img src="assets/avatars/avatar_1.png" alt="Avatar" class="profile-avatar"
                                    id="header-avatar-chat" onclick="app.toggleAvatarPicker()">
                                <span class="user-name" id="display-user-name-chat">Misafir</span>
                                <!-- Score removed from chat pane to avoid ID duplicate -->
                            </div>

                            <button id="btn-lang-toggle" class="lang-toggle-btn mode-en-tr"
                                onclick="app.toggleWritingDirection()">
                                <div class="toggle-content">
                                    <span class="lang-group">
                                        <img src="https://flagcdn.com/w40/gb.png" alt="UK" class="flag-img">
                                        <span class="lang-text">ƒ∞ng</span>
                                    </span>
                                    <span class="arrow-icon" id="toggle-arrow">‚û°</span>
                                    <span class="lang-group">
                                        <img src="https://flagcdn.com/w40/tr.png" alt="TR" class="flag-img">
                                        <span class="lang-text">Tr</span>
                                    </span>
                                </div>
                            </button>
                        </div>
                        <div id="ai-chat-messages" class="chat-messages">
                            <!-- Messages will appear here -->
                            <div class="chat-bubble ai">Merhaba! Sana √ßevirilerde yardƒ±m etmek i√ßin buradayƒ±m.
                                Ba≈ülayalƒ±m! üöÄ</div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- WRITING VIEW (Scramble Mode) -->
            <div id="view-modes" class="view hidden" style="padding: 0;">
                <div class="modes-split-layout">

                    <!-- AREA 1: LEADERBOARD (Top on Mobile) -->
                    <div class="area-leaderboard">
                        <div class="leaderboard-card">
                            <div class="lb-header">
                                <h3>üèÜ Liderlik Tablosu</h3>
                                <span class="badge-rush">Acele Modu</span>
                            </div>

                            <div class="table-wrapper">
                                <table class="lb-table">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Oyuncu</th>
                                            <th>Skor</th>
                                        </tr>
                                    </thead>
                                    <tbody id="leaderboard-body">
                                        <!-- JS Populated -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- AREA 2: MODES (Middle on Mobile) -->
                    <div class="area-modes">
                        <div class="modes-header-group">
                            <button class="btn-icon back-btn-top" onclick="app.showDashboard()" title="Geri">
                                &larr;
                            </button>
                            <h2>Oyun Modu</h2>
                        </div>
                        <p style="color:var(--text-secondary); margin-bottom:1rem; text-align:center;">Meydan okumanƒ±
                            se√ß.</p>

                        <div class="mode-grid-compact">
                            <div class="mode-card compact" onclick="app.showLevelMap()">
                                <div class="mode-icon">üèîÔ∏è</div>
                                <div class="mode-info">
                                    <h3>Kelime Ser√ºveni</h3>
                                    <p>100 Seviye, Artan Zorluk.</p>
                                </div>
                            </div>
                            <div class="mode-card compact" onclick="app.startGame('rush')">
                                <div class="mode-icon">‚ö°</div>
                                <div class="mode-info">
                                    <h3>Acele Modu</h3>
                                    <p>120 sn, rekor kƒ±r.</p>
                                </div>
                            </div>
                            <div class="mode-card compact" onclick="app.startGame('favorites')">
                                <div class="mode-icon">‚≠ê</div>
                                <div class="mode-info">
                                    <h3>Favoriler</h3>
                                    <p>Kendi kelimelerin.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AREA 3: FOOTER (Bottom on Mobile) -->
                    <div class="area-footer">
                        <button class="btn btn-secondary"
                            style="width:100%; display:flex; justify-content:center; align-items:center; gap:0.5rem;"
                            onclick="app.showWordList()">
                            <span>üìö</span> T√ºm Kelimeler & Favoriler
                        </button>
                    </div>
                </div>
            </div>

            <!-- GAME VIEW -->
            <div id="view-game" class="view hidden">
                <div class="game-header-bar" style="position:relative; justify-content:center;">
                    <!-- Level Positioned Absolutely to Global Left -->
                    <div id="level-indicator-container"
                        style="position:absolute; left:1rem; top:50%; transform:translateY(-50%); font-size:1.4rem; color:var(--text-secondary); font-weight:bold;">
                        Seviye <span id="current-level-display" style="color:var(--neon-gold)">1</span>
                    </div>

                    <!-- Centered Progress Info -->
                    <div id="level-info-container" class="level-info-container hidden"
                        style="flex:0 0 auto; text-align:center;">
                        <span id="level-progress-text"
                            style="font-size:1.8rem; font-weight:800; color:white; text-shadow:0 0 10px rgba(255,255,255,0.3); display:block;">0
                            / 50</span>
                        <div class="level-progress-track" style="width:150px; margin:5px auto;">
                            <div id="level-progress-fill" class="level-progress-fill" style="width:0%"></div>
                        </div>
                    </div>

                    <div class="live-score" style="display:none;">Skor: <span id="current-score">0</span></div>
                    <div id="game-timer" class="game-timer hidden">02:00</div>
                </div>

                <!-- Lives moved inside card container logic -->
                <div class="game-card" style="position:relative;">

                    <div class="card-header" style="justify-content: space-between; align-items: flex-start;">
                        <span id="word-level" class="level-indicator">A1</span>

                        <!-- Lives Centered Here -->
                        <div id="game-lives" class="game-lives hidden" style="font-size:1.5rem;">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>

                        <!-- Actions Container: Stacked Vertically -->
                        <div style="display:flex; flex-direction:column; gap:0.5rem; align-items:center;">
                            <!-- Favorite Star -->
                            <button id="game-star-btn" class="btn-star" onclick="app.toggleGameFavorite()">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <polygon
                                        points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2">
                                    </polygon>
                                </svg>
                            </button>

                            <!-- Speaker Button (New Position) -->
                            <button id="btn-speak" class="btn-star" onclick="app.speakCurrentWord()" title="Dinle"
                                style="font-size:1.2rem; display:flex; justify-content:center; align-items:center;">
                                üîä
                            </button>
                        </div>
                    </div>

                    <div class="word-display">
                        <h2 id="target-word">Placeholder</h2>
                    </div>

                    <div id="options-container" class="options-grid">
                        <!-- Options Generated by JS -->
                    </div>
                </div>

                <div style="margin-top:1rem; display:flex; justify-content:space-between; align-items:center">
                    <button class="btn btn-text" onclick="app.quitGame()">&larr; Vazge√ß</button>
                </div>
            </div>

            <!-- GAME OVER VIEW -->
            <div id="view-gameover" class="modal-overlay hidden">
                <div class="modal-content">
                    <h3>Oyun Bitti!</h3>

                    <div class="final-score-text">
                        Skorun
                        <span id="final-score">150</span>
                    </div>

                    <div class="earnings-report">
                        <!-- Wallet Earnings Removed -->
                    </div>

                    <div id="name-input-area" class="name-input-container hidden">
                        <!-- Name input is now handled globally in header or settings ideally, but keeping fallback -->
                    </div>

                    <div style="display:flex; gap:1rem; justify-content:center">
                        <button class="btn btn-secondary" onclick="app.handleGameOverExit()">√áƒ±kƒ±≈ü</button>
                        <button class="btn btn-primary" onclick="app.startGame()">Tekrar Oyna ‚Ü∫</button>
                    </div>
                </div>
            </div>

            <!-- LOGIN / REGISTER MODAL -->
            <div id="view-login-modal" class="modal-overlay hidden" style="z-index: 2000;">
                <div class="modal-content" style="max-width:400px; padding:2rem;">
                    <button class="btn-icon"
                        onclick="document.getElementById('view-login-modal').classList.add('hidden')"
                        style="position:absolute; top:1rem; right:1rem;">&times;</button>

                    <div style="text-align:center; margin-bottom:1.5rem;">
                        <span style="font-size:3rem;">üîê</span>
                        <h2 id="auth-title" style="margin-top:0.5rem; color:white;">Hesap Giri≈üi</h2>
                        <p id="auth-subtitle" style="color:var(--text-secondary);">Skorlarƒ±nƒ± kaydetmek ve sƒ±ralamaya
                            girmek i√ßin giri≈ü yap.</p>
                    </div>

                    <!-- Remembered Account View -->
                    <div id="remembered-account-view" class="hidden">
                        <div
                            style="background:rgba(255,255,255,0.05); padding:1rem; border-radius:12px; margin-bottom:1.5rem; text-align:center; border:1px solid var(--border-glass);">
                            <div style="font-size:0.8rem; color:var(--text-secondary); margin-bottom:0.3rem;">Kayƒ±tlƒ±
                                Hesap:</div>
                            <div id="remembered-email-display"
                                style="font-weight:bold; color:var(--accent-gold); font-size:1.1rem; word-break:break-all;">
                                ...</div>
                        </div>
                        <input type="password" id="rem-login-password" class="landing-input"
                            placeholder="≈ûifrenizi girin" style="margin-bottom:1rem;">
                        <button class="btn btn-primary" onclick="app.submitLogin(true)"
                            style="width:100%; padding:0.8rem;">Giri≈ü Yap &rarr;</button>
                        <button class="btn btn-text" onclick="app.resetRememberedEmail()"
                            style="width:100%; margin-top:1rem; font-size:0.8rem; opacity:0.7;">Ba≈üka bir hesapla giri≈ü
                            yap</button>
                    </div>

                    <!-- Standard Auth View -->
                    <div id="standard-auth-view">
                        <!-- Tabs -->
                        <div id="auth-tabs"
                            style="display:flex; justify-content:center; gap:1rem; margin-bottom:1.5rem; border-bottom:1px solid var(--border-glass); padding-bottom:0.5rem;">
                            <button id="tab-login" class="btn-text active" onclick="app.switchAuthTab('login')"
                                style="color:var(--accent-gold); font-weight:bold; border-bottom:2px solid var(--accent-gold);">Giri≈ü
                                Yap</button>
                            <button id="tab-register" class="btn-text" onclick="app.switchAuthTab('register')"
                                style="color:var(--text-secondary);">Kayƒ±t Ol</button>
                        </div>

                        <!-- Login Form -->
                        <div id="form-login">
                            <input type="email" id="login-email" class="landing-input" placeholder="E-Posta Adresi"
                                style="margin-bottom:1rem;">
                            <input type="password" id="login-password" class="landing-input" placeholder="≈ûifre"
                                style="margin-bottom:1rem;">
                            <button class="btn btn-primary" onclick="app.submitLogin()"
                                style="width:100%; padding:0.8rem;">Giri≈ü Yap &rarr;</button>
                        </div>

                        <!-- Register Form -->
                        <div id="form-register" class="hidden">
                            <input type="text" id="reg-username" class="landing-input"
                                placeholder="Oyun ƒ∞smin (G√∂r√ºnecek Ad)" style="margin-bottom:1rem;">
                            <input type="email" id="reg-email" class="landing-input" placeholder="E-Posta Adresi"
                                style="margin-bottom:1rem;">
                            <input type="password" id="reg-password" class="landing-input"
                                placeholder="≈ûifre (En az 6 karakter)" style="margin-bottom:1rem;">
                            <button class="btn btn-primary" onclick="app.submitRegister()"
                                style="width:100%; padding:0.8rem;">Kayƒ±t Ol &rarr;</button>
                        </div>
                    </div>

                    <p id="auth-error-msg"
                        style="color:#ef4444; font-size:0.9rem; margin-top:1rem; text-align:center; min-height:1.2em;">
                    </p>
                </div>
            </div>

            <!-- WORD LIST VIEW -->
            <div id="view-list" class="view hidden">
                <div class="list-header">
                    <div
                        style="position: relative; display: flex; justify-content: center; align-items: center; margin-bottom: 1rem; min-height: 40px;">
                        <button class="btn-icon back-btn-top" onclick="app.openModeSelection()" title="Geri"
                            style="position: absolute; left: 2px; top: 50%; transform: translateY(-50%);">
                            &larr;
                        </button>
                        <h2 style="margin:0; font-size:1.5rem;">Kelimeler</h2>
                    </div>

                    <div class="search-bar">
                        <input type="text" id="search-input" placeholder="Kelime ara..." onkeyup="app.filterList()">
                    </div>
                    <div class="filter-tabs">
                        <button class="filter-tab active" id="filter-all" onclick="app.setListFilter('all')">
                            <span>üìö</span> T√ºm√º <span id="total-word-count"
                                style="font-size:0.8em; opacity:0.7; margin-left:4px">(0)</span>
                        </button>
                        <button class="filter-tab" id="filter-favs" onclick="app.setListFilter('favs')">
                            <span>‚≠ê</span> Favoriler
                        </button>
                    </div>

                    <!-- Level Filters -->
                    <div class="level-filters">
                        <button class="level-chip active" onclick="app.setLevelFilter('all', this)">T√ºm
                            Seviyeler</button>
                        <button class="level-chip" onclick="app.setLevelFilter('A1', this)">A1</button>
                        <button class="level-chip" onclick="app.setLevelFilter('A2', this)">A2</button>
                        <button class="level-chip" onclick="app.setLevelFilter('B1', this)">B1</button>
                        <button class="level-chip" onclick="app.setLevelFilter('B2', this)">B2</button>
                        <button class="level-chip" onclick="app.setLevelFilter('C1', this)">C1</button>
                        <button class="level-chip" onclick="app.setLevelFilter('C2', this)">C2</button>
                    </div>
                </div>
                <div id="word-list-items" class="word-list-container">
                    <!-- Items JS -->
                </div>
            </div>

            <!-- GLOBAL LEADERBOARD VIEW (Dedicated for Cups) -->
            <div id="view-global-leaderboard" class="view hidden">
                <div class="global-leaderboard-header">
                    <button class="back-btn-top" onclick="app.showDashboard()" title="Geri">
                        <span class="back-icon">‚Üê</span>
                    </button>
                    <div class="header-content">
                        <h2 class="header-title">üèÜ Global Sƒ±ralama</h2>
                        <p class="header-subtitle">En √ßok Kupaya Sahip Oyuncular</p>
                    </div>
                </div>

                <div class="global-leaderboard-container">
                    <div class="leaderboard-card-main">
                        <div class="table-header-row">
                            <span class="col-rank">#</span>
                            <span class="col-player">Oyuncu</span>
                            <span class="col-score">Kupa</span>
                        </div>
                        <ul id="global-leaderboard-list">
                            <li class="loading-state">Y√ºkleniyor...</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- LEVEL MAP VIEW -->
            <div id="view-level-map" class="view hidden" style="padding:0; overflow:hidden;">
                <!-- Fixed Header independent of scroll -->
                <!-- Fixed Header independent of scroll -->
                <div class="map-fixed-header"
                    style="position:absolute; top:1rem; left:1rem; z-index:50; pointer-events:none;">
                    <button class="btn-icon back-btn-top" onclick="app.openModeSelection()" title="Geri"
                        style="pointer-events:auto; background:rgba(15, 23, 42, 0.6); backdrop-filter:blur(5px); border:1px solid rgba(255,255,255,0.2);">
                        &larr;
                    </button>
                </div>

                <!-- Scrollable Container -->
                <div class="map-scroll-area" style="overflow-y:auto; height:100%; padding-top:20px;">
                    <div id="level-map-container" class="level-map-container">
                        <!-- Nodes Generated by JS -->
                    </div>
                </div>
            </div>



            <!-- WRITING VIEW (Scramble Mode) -->
            <div id="view-writing" class="view hidden" style="padding-top: 6rem;">
                <div class="game-header-bar">
                    <button class="btn-icon back-btn-top" onclick="app.goBackFromWriting()" title="Geri">&larr;</button>
                    <div id="writing-score-container"
                        style="font-size:1.2rem; font-weight:bold; margin-top:-10px; margin-right:20px;">
                        Puan: <span id="writing-score" style="color:var(--neon-blue)">0</span></div>
                </div>

                <div class="game-card" style="justify-content:center; gap:2rem;">
                    <!-- Question Area -->
                    <div style="text-align:center;">
                        <span style="font-size:1rem; opacity:0.7; display:block; margin-bottom:0.5rem">Bu kelimenin
                            ƒ∞ngilizcesi ne?</span>
                        <h2 id="writing-target-meaning"
                            style="font-size:2.5rem; color:var(--accent-gold); text-shadow:0 0 10px rgba(245,158,11,0.5)">
                            Elma
                        </h2>
                        <button class="btn-star" onclick="app.speakCurrentWord()" title="Dinle"
                            style="font-size:1.2rem; display:inline-flex; justify-content:center; align-items:center; margin-top:0.5rem;">
                            üîä
                        </button>
                    </div>

                    <!-- Slots Area -->
                    <div id="writing-slots"
                        style="display:flex; justify-content:center; gap:0.5rem; flex-wrap:wrap; min-height:60px;">
                        <!-- Generated via JS -->
                    </div>

                    <!-- Letters Area -->
                    <div id="writing-pool"
                        style="display:flex; justify-content:center; gap:0.5rem; flex-wrap:wrap; margin-top:2rem;">
                        <!-- Generated via JS -->
                    </div>

                    <!-- Feedback Area -->
                    <div id="writing-feedback" style="height:2rem; font-weight:bold; color:var(--text-primary);"></div>
                </div>

                <div style="margin-top:2rem; display:flex; justify-content:center; gap:1rem;">
                    <button id="btn-scramble-clear" class="btn btn-secondary" onclick="app.clearWritingSlots()">TEMƒ∞ZLE
                        üßπ</button>
                    <button id="btn-scramble-check" class="btn btn-primary" onclick="app.checkWritingAnswer()">KONTROL
                        ET ‚úÖ</button>
                    <button id="btn-scramble-next" class="btn btn-primary hidden"
                        onclick="app.nextScrambleQuestion()">DEVAM ET ‚û°</button>
                </div>
            </div>

            <!-- GRAMMAR LEVEL SELECTION VIEW -->
            <div id="view-grammar-intro" class="view hidden">
                <button class="btn-icon back-btn-top" onclick="app.showDashboard()" title="Geri"
                    style="position:fixed; top:1rem; left:1rem; z-index:100;">
                    &larr;
                </button>

                <!-- Grammar Explanation Modal -->
                <div id="grammar-explanation-modal" class="modal hidden"
                    style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; z-index:200; background:rgba(0,0,0,0.8); backdrop-filter:blur(5px); justify-content:center; align-items:center;">
                    <div class="modal-content"
                        style="background:var(--bg-surface); width:90%; max-width:800px; max-height:85vh; border-radius:16px; border:1px solid var(--neon-purple); display:flex; flex-direction:column; box-shadow:0 0 30px rgba(139, 92, 246, 0.3);">
                        <div class="modal-header"
                            style="padding:1.5rem; border-bottom:1px solid var(--border-glass); display:flex; justify-content:space-between; align-items:center;">
                            <h2 id="explanation-title" style="margin:0; color:var(--neon-purple); font-size:1.5rem;">
                                Topic Title</h2>
                            <button onclick="app.closeGrammarExplanation()"
                                style="background:none; border:none; color:var(--text-secondary); font-size:1.5rem; cursor:pointer;">&times;</button>
                        </div>
                        <div id="explanation-body"
                            style="padding:1.5rem; overflow-y:auto; line-height:1.6; color:var(--text-primary);">
                            <!-- Content will be injected here -->
                        </div>
                    </div>
                </div>

                <div class="modes-split-layout"
                    style="justify-content:flex-start; align-items:center; flex-direction:column; padding-top:4rem; overflow-y:auto; width:100%;">

                    <div class="modes-header-group" style="text-align:center; margin-bottom:1.5rem; width:100%;">
                        <h2 style="font-size:2.5rem;">Dil Bilgisi</h2>
                        <p style="color:var(--text-secondary); font-size:0.95rem;">√áalƒ±≈ümak istediƒüin konuyu se√ß</p>
                    </div>

                    <div class="grammar-topics-grid">
                        <!-- Tenses -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('tenses')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('tenses')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">‚è∞</div>
                            <div class="topic-info">
                                <h3>Tenses (Zamanlar)</h3>
                                <p>Present, Past, Future</p>
                                <span class="topic-count">5 Soru</span>
                            </div>
                        </div>

                        <!-- Conditionals -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('conditionals')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('conditionals')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üîÄ</div>
                            <div class="topic-info">
                                <h3>Conditionals (≈ûartlar)</h3>
                                <p>If Clauses</p>
                                <span class="topic-count">3 Soru</span>
                            </div>
                        </div>

                        <!-- Modals -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('modals')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('modals')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üéØ</div>
                            <div class="topic-info">
                                <h3>Modals</h3>
                                <p>Can, Must, Should...</p>
                                <span class="topic-count">2 Soru</span>
                            </div>
                        </div>

                        <!-- Articles & Determiners -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('articles')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('articles')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üìù</div>
                            <div class="topic-info">
                                <h3>Articles & Determiners</h3>
                                <p>A/An/The, Some/Any</p>
                                <span class="topic-count">2 Soru</span>
                            </div>
                        </div>

                        <!-- Prepositions -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('prepositions')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('prepositions')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üìç</div>
                            <div class="topic-info">
                                <h3>Prepositions (Edatlar)</h3>
                                <p>In, On, At...</p>
                                <span class="topic-count">1 Soru</span>
                            </div>
                        </div>

                        <!-- Passive Voice -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('passive')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('passive')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üîÑ</div>
                            <div class="topic-info">
                                <h3>Passive Voice</h3>
                                <p>Edilgen Yapƒ±</p>
                                <span class="topic-count">1 Soru</span>
                            </div>
                        </div>

                        <!-- Reported Speech -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('reported')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('reported')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üí¨</div>
                            <div class="topic-info">
                                <h3>Reported Speech</h3>
                                <p>Dolaylƒ± Anlatƒ±m</p>
                                <span class="topic-count">1 Soru</span>
                            </div>
                        </div>

                        <!-- Relative Clauses -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('relative')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('relative')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üîó</div>
                            <div class="topic-info">
                                <h3>Relative Clauses</h3>
                                <p>Who, Which, That</p>
                                <span class="topic-count">Hazƒ±rlanƒ±yor...</span>
                            </div>
                        </div>

                        <!-- Gerunds & Infinitives -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('gerunds')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('gerunds')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üèä</div>
                            <div class="topic-info">
                                <h3>Gerunds & Infinitives</h3>
                                <p>Doing vs To Do</p>
                                <span class="topic-count">Hazƒ±rlanƒ±yor...</span>
                            </div>
                        </div>

                        <!-- Phrasal Verbs -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('phrasal')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('phrasal')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üöÄ</div>
                            <div class="topic-info">
                                <h3>Phrasal Verbs</h3>
                                <p>Run out, Give up...</p>
                                <span class="topic-count">1 Soru</span>
                            </div>
                        </div>

                        <!-- Comparatives & Superlatives -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('comparatives')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('comparatives')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üìä</div>
                            <div class="topic-info">
                                <h3>Comparatives & Superlatives</h3>
                                <p>-er, -est, more, most</p>
                                <span class="topic-count">1 Soru</span>
                            </div>
                        </div>

                        <!-- Possessives -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('possessives')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('possessives')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üë§</div>
                            <div class="topic-info">
                                <h3>Possessives</h3>
                                <p>My, Your, His...</p>
                                <span class="topic-count">Loading...</span>
                            </div>
                        </div>

                        <!-- Adjectives & Adverbs -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('adjectives_adverbs')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('adjectives_adverbs')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">‚ö°</div>
                            <div class="topic-info">
                                <h3>Adjectives & Adverbs</h3>
                                <p>Quick vs Quickly</p>
                                <span class="topic-count">Loading...</span>
                            </div>
                        </div>

                        <!-- Conjunctions -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('conjunctions')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('conjunctions')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üîó</div>
                            <div class="topic-info">
                                <h3>Conjunctions</h3>
                                <p>And, But, So, Because</p>
                                <span class="topic-count">Loading...</span>
                            </div>
                        </div>

                        <!-- Quantifiers & Noun Clauses -->
                        <div class="grammar-topic-card" onclick="app.startGrammarMode('quantifiers_noun_clauses')">
                            <button class="info-btn"
                                onclick="event.stopPropagation(); app.showGrammarExplanation('quantifiers_noun_clauses')"
                                title="Konu Anlatƒ±mƒ±">‚ÑπÔ∏è</button>
                            <div class="topic-icon">üî¢</div>
                            <div class="topic-info">
                                <h3>Quantifiers & Noun Clauses</h3>
                                <p>Some, Any, That...</p>
                                <span class="topic-count">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GRAMMAR GAME VIEW -->
            <div id="view-grammar" class="view hidden" style="padding-top: 8rem;">
                <div class="game-header-bar"
                    style="position: fixed; top: 0; left: 0; width: 100%; z-index: 1000; background: transparent; backdrop-filter: none; border: none; padding: 0.5rem; justify-content: flex-start;">
                    <!-- Back Button: Darker visual style, fixed header -->
                    <button class="btn-icon back-btn-top" onclick="app.openGrammarLevelSelection()" title="Geri"
                        style="background:rgba(2, 6, 23, 0.95); border:1px solid rgba(255,255,255,0.1); width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-left: 0.5rem; box-shadow: 0 4px 12px rgba(0,0,0,0.5);">&larr;</button>
                </div>

                <div class="game-card"
                    style="justify-content:center; gap:2rem; transform: scale(0.95); transform-origin: center top;">
                    <!-- Topic -->
                    <div style="text-align:center; margin-bottom:1rem;">
                        <span id="grammar-topic"
                            style="background:rgba(139, 92, 246, 0.2); color:var(--neon-purple); padding:0.3rem 0.8rem; border-radius:12px; font-size:0.9rem; font-weight:600;">Topic</span>
                    </div>

                    <!-- Question Area -->
                    <div style="text-align:center;">
                        <h2 id="grammar-question" style="font-size:2rem; line-height:1.4;">
                            She ____ my friend.
                        </h2>
                    </div>

                    <!-- Options Area -->
                    <div id="grammar-options"
                        style="display:flex; justify-content:center; gap:1rem; flex-wrap:wrap; margin-top:2rem;">
                        <!-- Buttons Generated via JS -->
                    </div>

                    <!-- Feedback Area -->
                    <div id="grammar-feedback" style="margin-top:2rem; min-height:60px; text-align:center;">
                        <div id="grammar-feedback-text"
                            style="font-weight:bold; font-size:1.2rem; margin-bottom:0.5rem;"></div>
                        <div id="grammar-explanation" style="color:var(--text-secondary); font-size:0.95rem;"></div>
                    </div>

                    <!-- Continue Buttons (Moved Inside Card) -->
                    <div style="margin-top:2rem; display:flex; justify-content:center; gap: 1rem;">
                        <button id="btn-grammar-pass" class="btn"
                            style="background:rgba(255,255,255,0.1); color:var(--text-secondary); border:1px solid rgba(255,255,255,0.1); font-weight:600; min-width: 120px;"
                            onclick="app.passGrammarQuestion()">Pas Ge√ß</button>
                        <button id="btn-grammar-next" class="btn btn-primary" style="display:none; min-width: 120px;"
                            onclick="app.nextGrammarQuestion()">Devam Et &rarr;</button>
                    </div>
                </div>
            </div>

            <!-- LEADERBOARD VIEW (New) -->
            <div id="view-leaderboard" class="view hidden">
                <div class="modes-header-group" style="text-align:center; margin-top:4rem; margin-bottom:2rem;">
                    <button class="btn-icon back-btn-top" onclick="app.showDashboard()" title="Geri"
                        style="position:absolute; top:2rem; left:2rem;">
                        &larr;
                    </button>
                    <h2 style="font-size:2.5rem; color:var(--accent-gold);">üèÜ Liderlik Tablosu</h2>
                    <p style="color:var(--text-secondary);">En iyi oyuncular</p>
                </div>

                <div class="game-card" style="max-width:600px; margin:0 auto; padding:0;">
                    <table class="leaderboard-table" style="width:100%; border-collapse:collapse;">
                        <thead>
                            <tr style="background:rgba(255,255,255,0.05); color:var(--text-secondary);">
                                <th style="padding:1rem; text-align:left;">#</th>
                                <th style="padding:1rem; text-align:left;">Oyuncu</th>
                                <th style="padding:1rem; text-align:left;">Puan</th>
                            </tr>
                        </thead>
                        <tbody id="leaderboard-body">
                            <!-- Populated by JS -->
                            <tr>
                                <td colspan="3" style="text-align:center; padding:2rem;">Y√ºkleniyor...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ADMIN VIEW -->
            <div id="view-admin" class="view hidden">
                <h2 style="text-align:center; margin-bottom:2rem; color:var(--accent-gold)">Y√∂netici Paneli</h2>

                <div class="admin-grid">
                    <button class="btn btn-secondary" onclick="app.performShowAddWord()">
                        <span style="font-size:2rem; display:block">üìù</span>
                        Kelime Ekle
                    </button>

                    <button class="btn btn-secondary" onclick="app.resetProgress()">
                        <span style="font-size:2rem; display:block">üóëÔ∏è</span>
                        ƒ∞lerlemeyi Sƒ±fƒ±rla
                    </button>

                    <button class="btn btn-secondary" onclick="app.resetTrophyLeaderboard()"
                        style="border-color: #ef4444; color: #ef4444;">
                        <span style="font-size:2rem; display:block">üèÜ</span>
                        Kupa Tablosunu Sƒ±fƒ±rla
                    </button>

                    <button class="btn btn-primary" onclick="app.openModeSelection()"
                        style="grid-column: 1 / -1; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; border:none; box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);">
                        <span style="font-size:2rem; display:block">üéÆ</span>
                        Y√∂netici Olarak Oyuna D√∂n<br><span style="font-size:0.8rem; opacity:0.9">(Kilitler A√ßƒ±k)</span>
                    </button>
                </div>

                <div style="margin-top:3rem; text-align:center">
                    <button class="btn btn-text" onclick="app.showLanding()">
                        &larr; √áƒ±kƒ±≈ü Yap
                    </button>
                </div>
            </div>

            <!-- ADD WORD VIEW (Admin Sub-view) -->
            <div id="view-add-word" class="view hidden">
                <h3 style="margin-bottom:1.5rem; text-align:center">Yeni Kelime Ekle (Global)</h3>

                <div class="form-group">
                    <label>ƒ∞ngilizce Kelime</label>
                    <input type="text" id="new-word-en" autocomplete="off">
                </div>

                <div class="form-group">
                    <label>T√ºrk√ße Kar≈üƒ±lƒ±ƒüƒ±</label>
                    <input type="text" id="new-word-tr" autocomplete="off">
                </div>

                <div class="form-group">
                    <label>Seviye</label>
                    <div class="level-select">
                        <button class="lvl-btn active" onclick="app.selectLevel('A1', this)">A1</button>
                        <button class="lvl-btn" onclick="app.selectLevel('A2', this)">A2</button>
                        <button class="lvl-btn" onclick="app.selectLevel('B1', this)">B1</button>
                        <button class="lvl-btn" onclick="app.selectLevel('B2', this)">B2</button>
                        <button class="lvl-btn" onclick="app.selectLevel('C1', this)">C1</button>
                    </div>
                </div>

                <div style="margin-top:2rem; display:flex; gap:1rem">
                    <button class="btn btn-secondary" onclick="app.showAdmin()">ƒ∞ptal</button>
                    <button class="btn btn-primary" onclick="app.saveNewWord()">Kaydet</button>
                </div>
            </div>

            <!-- PASSWORD MODAL -->
            <div id="view-password-modal" class="modal-overlay hidden">
                <div class="modal-content">
                    <p id="password-modal-msg" style="margin-bottom:1rem">Parola:</p>
                    <input type="password" id="reset-password-input" class="password-input"
                        style="width:100%; padding:0.8rem; margin-bottom:1rem; background:rgba(255,255,255,0.1); border:1px solid #555; color:white; text-align:center">
                    <div style="display:flex; gap:1rem; justify-content:center">
                        <button class="btn btn-secondary" onclick="app.closePasswordModal()">ƒ∞ptal</button>
                        <button class="btn btn-primary" onclick="app.submitPassword()">Onayla</button>
                    </div>
                </div>
            </div>

            <!-- LOGOUT CONFIRMATION MODAL -->
            <div id="logout-confirmation-modal" class="modal-overlay hidden">
                <div class="modal-content">
                    <h3 style="margin-bottom:1.5rem; color:var(--text-primary)">√áƒ±kƒ±≈ü Yap</h3>
                    <p style="margin-bottom:2rem; color:var(--text-secondary)">√áƒ±kƒ±≈ü yapmak istediƒüinizden emin misiniz?
                    </p>
                    <div style="display:flex; gap:1rem; justify-content:center">
                        <button class="btn btn-secondary" onclick="app.closeLogoutModal()">ƒ∞ptal</button>
                        <button class="btn btn-primary" onclick="app.confirmLogout()">√áƒ±kƒ±≈ü Yap</button>
                    </div>
                </div>
            </div>

            <!-- GAME OVER MODAL (Adventure Mode) -->
            <div id="game-over-modal" class="modal-overlay hidden">
                <div class="modal-content">
                    <h3 style="margin-bottom:1rem; color:#ef4444; font-size:2rem">üíî Oyun Bitti</h3>
                    <p style="margin-bottom:2rem; color:var(--text-secondary); font-size:1.1rem">Maalesef yandƒ±nƒ±z!</p>
                    <div style="display:flex; gap:1rem; justify-content:center">
                        <button class="btn btn-secondary" onclick="app.exitToLevelMap()">√áƒ±kƒ±≈ü Yap</button>
                        <button class="btn btn-primary" onclick="app.retryAdventure()">Tekrar Dene</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    </div>

    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics-compat.js"></script>

    <script src="js/words.js?v=22"></script>
    <script src="js/basic_vocabulary.js"></script>
    <script src="js/sentences.js?v=4"></script>
    <script src="js/grammar.js?v=33"></script>
    <script src="js/grammar_explanations.js?v=33"></script>
    <script src="js/books.js"></script>
    <script src="js/app.js?v=34"></script>

    <!-- DICTIONARY TOAST (Re-injected) -->
    <div id="dict-toast" class="dict-toast">
        <div class="dict-content">
            <div class="dict-header">
                <span id="dict-word" class="dict-word">Word</span>
                <span id="dict-level" class="dict-level">A1</span>
            </div>
            <div id="dict-meaning" class="dict-meaning">Meaning goes here</div>
        </div>
        <div class="dict-actions">
            <button id="dict-star-btn" class="btn-dict-star" onclick="app.toggleDictToastFavorite()"
                title="Favorilere Ekle">
                <svg viewBox="0 0 24 24">
                    <polygon
                        points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2">
                    </polygon>
                </svg>
            </button>
        </div>
    </div>
</body>

</html>
```